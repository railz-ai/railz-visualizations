<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0"
    />
    <title>Javascript Example</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      type="module"
      src="https://cdn.jsdelivr.net/npm/@railzai/railz-visualizations@0.0.8-alpha.5/dist/railzvisualizations/railzvisualizations.esm.js"
    ></script>
    <script
      nomodule
      src="https://cdn.jsdelivr.net/npm/@railzai/railz-visualizations@0.0.8-alpha.5/dist/railzvisualizations/railzvisualizations.js"
    ></script>
  </head>

  <body>
    <div class="container mx-auto">
      <nav class="bg-gray-800">
        <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
          <div class="flex items-center justify-between h-16">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <img
                  class="h-8 w-8"
                  src="https://pbs.twimg.com/profile_images/1325486360682180614/p8pwyjLY_400x400.png"
                  alt="Workflow"
                />
              </div>
              <div class="md:block">
                <div class="ml-10 flex items-baseline space-x-4">
                  <a
                    class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium"
                    routerLink="/basic"
                    routerLinkActive="bg-gray-900 text-white"
                    >Basic</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>

      <header class="bg-white shadow">
        <div class="max-w-full mx-auto py-6 px-4 sm:px-6 lg:px-8">
          <h1 class="text-3xl font-bold text-gray-900">Sample Dashboard</h1>
          <p className="mt-1 text-md text-gray-600">
            This is a quickstart example of an Javascript application that consumes the Railz
            Visualizations SDK.
          </p>
          <div class="mt-1 flex flex-col sm:flex-row sm:flex-wrap sm:mt-0 sm:space-x-6">
            <div class="mt-2 flex items-center text-sm text-gray-500">
              <!-- Heroicon name: solid/calendar -->
              <svg
                class="flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                aria-hidden="true"
              >
                <path
                  fill-rule="evenodd"
                  d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z"
                  clip-rule="evenodd"
                />
              </svg>
              Updated on May 13, 2022
            </div>
            <div class="mt-2 flex items-center text-sm text-gray-500">
              <!-- Heroicon name: solid/tag -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z"
                  clip-rule="evenodd"
                />
              </svg>
              Version 0.0.7
            </div>
          </div>
        </div>
      </header>
      <div class="grid grid-cols-2">
        <form action="">
          <div class="max-w-full mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <div>
              <div class="flex flex-col">
                <div class="text-left">
                  <h2 class="text-lg font-medium leading-6 text-gray-900">Authentication</h2>
                  <p class="mt-1 text-sm text-gray-600">
                    Include your Authentication server URL here, see our quickstart example
                    <!-- update this href away from nodejs example -->
                    <a
                      href="https://github.com/railz-ai/railz-visualizations/tree/master/examples/nodejs"
                      target="_blank"
                      class="underline"
                      rel="noopener noreferrer"
                      >here</a
                    >.
                  </p>
                  <p class="mt-1 text-sm text-gray-600 font-bold">
                    This is not implemented by the SDK.
                  </p>
                </div>
                <div class="mt-4 md:mt-3 text-left items-end">
                  <div class="overflow-hidden sm:rounded-md">
                    <div class="grid grid-cols-6 gap-6 items-end">
                      <div class="col-span-6 sm:col-span-6">
                        <label for="auth-url" class="block text-sm font-medium text-gray-700"
                          >Auth Url</label
                        >
                        <input
                          type="text"
                          name="auth-url"
                          id="auth-url"
                          class="mt-1 focus:ring-green-500 focus:border-green-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"
                          placeholder="http://localhost:4000/authenticate"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="mx-auto">
              <div class="flex flex-col mt-6">
                <div class="px-4 sm:px-0">
                  <h3 class="text-lg font-medium leading-6 text-gray-900">Filters</h3>
                  <p class="mt-1 text-sm text-gray-600">
                    Some fields are disabled based on criteria
                    <a
                      href="https://docs.railz.ai/docs/visualization-sdk-components"
                      target="_blank"
                      class="underline"
                      rel="noopener noreferrer"
                      >here</a
                    >.
                  </p>
                </div>
                <div class="mt-5 md:mt-0">
                  <div class="overflow-hidden sm:rounded-md">
                    <div class="py-5 bg-white">
                      <div class="grid grid-cols-6 gap-6 items-end">
                        <div class="col-span-6 lg:col-span-6">
                          <label for="business-name" class="block text-sm font-medium text-gray-700"
                            >Business Name</label
                          >
                          <input
                            type="text"
                            name="business-name"
                            id="business-name"
                            class="mt-1 focus:ring-green-500 focus:border-green-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"
                            placeholder="BIZ-1223S"
                          />
                        </div>
                        <div class="col-span-6 lg:col-span-3">
                          <label for="service-name" class="block text-sm font-medium text-gray-700"
                            >Service Name</label
                          >
                          <select
                            id="service-name"
                            name="service-name"
                            required
                            class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"
                          >
                            <option value="dynamicsBusinessCentral">dynamicsBusinessCentral</option>
                            <option value="freshbooks">freshbooks</option>
                            <option value="quickbooks">quickbooks</option>
                            <option value="quickbooksDesktop">quickbooksDesktop</option>
                            <option value="oracleNetsuite">oracleNetsuite</option>
                            <option value="sageBusinessCloud">sageBusinessCloud</option>
                            <option value="sageIntacct">sageIntacct</option>
                            <option value="xero">xero</option>
                            <option value="plaid">plaid</option>
                            <option value="wave">wave</option>
                          </select>
                        </div>
                        <div class="col-span-6 lg:col-span-3">
                          <label for="report-type" class="block text-sm font-medium text-gray-700"
                            >Report Type</label
                          >
                          <select
                            id="report-type"
                            name="report-type"
                            class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"
                          >
                            <option value="balanceSheets">balanceSheets</option>
                            <option value="bills">bills</option>
                            <option value="cashflowStatements">cashflowStatements</option>
                            <option value="creditScore">creditScore</option>
                            <option value="expenses">expenses</option>
                            <option value="financialRatios">financialRatios</option>
                            <option value="incomeStatements">incomeStatements</option>
                            <option value="invoices">invoices</option>
                            <option value="revenue">revenue</option>
                          </select>
                        </div>
                        <div class="col-span-6 lg:col-span-3">
                          <label for="start-date" class="block text-sm font-medium text-gray-700"
                            >Start Date</label
                          >
                          <input
                            type="date"
                            name="start-date"
                            id="start-date"
                            class="mt-1 focus:ring-green-500 focus:border-green-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"
                            placeholder="2020-01-01"
                          />
                        </div>
                        <div class="col-span-6 lg:col-span-3">
                          <label for="end-date" class="block text-sm font-medium text-gray-700"
                            >End Date</label
                          >
                          <input
                            type="date"
                            name="end-date"
                            id="end-date"
                            class="mt-1 focus:ring-green-500 focus:border-green-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"
                            placeholder="2020-12-01"
                          />
                        </div>
                        <div class="col-span-6 lg:col-span-3">
                          <label
                            for="report-frequency"
                            class="block text-sm font-medium text-gray-700"
                            >Report Frequency</label
                          >
                          <select
                            id="report-frequency"
                            name="report-frequency"
                            class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm"
                          >
                            <option value="month">month</option>
                            <option value="quarter">quarter</option>
                            <option value="year">year</option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div class="col-span-6 lg:col-span-6 items-end">
                      <button
                        type="submit"
                        class="inline-flex justify-center w-full place-items-end py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-800"
                      >
                        Submit
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </form>
        <div>
          <div id="chart-content" class="m-4"></div>

          <pre class="language-html bg-black text-white mt-4 p-4 rounded-xl overflow-auto text-xs">
            <code id="code">
            </code>
          </pre>
        </div>
      </div>
    </div>

    <script>
      const formElem = document.querySelector('form');
      formElem.addEventListener('submit', async (e) => {
        // on form submission, prevent default
        e.preventDefault();

        const response = await fetch(
          document.getElementById('auth-url').value || 'http://localhost:4000/authenticate',
          {
            method: 'GET',
          },
        );
        const result = await response.json();

        const configuration = {
          token: result.access_token,
          debug: true,
        };

        let rv = document.createElement('railz-visualizations');
        rv.configuration = configuration;

        const formData = new FormData(formElem);
        const businessName = formData.get('business-name');
        const startDate = formData.get('start-date');
        const endDate = formData.get('end-date');
        const reportFrequency = formData.get('report-frequency');
        const serviceName = formData.get('service-name');
        const reportType = formData.get('report-type');

        const filter = {
          businessName,
          startDate,
          endDate,
          reportFrequency,
          serviceName,
          reportType,
        };
        rv.filter = filter;
        document.getElementById('chart-content').replaceChildren(rv);

        const sourceCode = `
<railz-visualizations
  configuration="${JSON.stringify(
    { token: configuration.token.slice(0, 20) + '...', debug: configuration.debug },
    null,
    4,
  )}"
  filter="${JSON.stringify(filter, null, 4)}">
</railz-visualizations>`;

        document.getElementById('code').textContent = sourceCode;
      });
    </script>
  </body>
</html>
